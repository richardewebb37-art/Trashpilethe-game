package com.trashapp.gcms.progression

/**
 * Skill
 * Represents a purchasable skill in the progression tree
 * Skills are passive bonuses that grant XP when purchased
 */
data class Skill(
    val id: String,
    val name: String,
    val description: String,
    val cost: Int,                    // Points cost to purchase
    val xpGranted: Int,               // XP granted when purchased
    val icon: String? = null,         // Icon resource name
    val category: SkillCategory = SkillCategory.OFFENSE,
    val rarity: SkillRarity = SkillRarity.COMMON,
    val maxLevel: Int = 5,            // Maximum skill level
    val currentLevel: Int = 0,        // Current skill level
    val prerequisites: List<String> = emptyList(),  // Required skill IDs
    val unlocks: List<String> = emptyList(),        // Skills this unlocks
    val isUnlocked: Boolean = false,  // Is this skill available for purchase?
    val isPurchased: Boolean = false  // Has this skill been purchased?
) {
    /**
     * Check if skill can be leveled up
     */
    fun canLevelUp(): Boolean {
        return isPurchased &amp;&amp; currentLevel < maxLevel
    }
    
    /**
     * Check if skill can be purchased
     */
    fun canPurchase(availablePoints: Int): Boolean {
        return isUnlocked &amp;&amp; !isPurchased &amp;&amp; availablePoints >= cost
    }
    
    /**
     * Calculate cost for next level
     */
    fun levelUpCost(): Int {
        if (currentLevel == 0) return cost
        return cost * (currentLevel + 1)
    }
    
    /**
     * Calculate XP granted for level up
     */
    fun levelUpXP(): Int {
        if (currentLevel == 0) return xpGranted
        return xpGranted * (currentLevel + 1)
    }
    
    /**
     * Purchase this skill
     */
    fun purchase(): Skill {
        return copy(
            currentLevel = 1,
            isPurchased = true
        )
    }
    
    /**
     * Level up this skill
     */
    fun levelUp(): Skill {
        return copy(
            currentLevel = currentLevel + 1
        )
    }
    
    /**
     * Refund (sell) this skill
     */
    fun refund(): Skill {
        return copy(
            currentLevel = 0,
            isPurchased = false
        )
    }
    
    /**
     * Get progress to next level (0.0 to 1.0)
     */
    fun levelProgress(): Float {
        return currentLevel.toFloat() / maxLevel.toFloat()
    }
}

/**
 * Skill Categories
 */
enum class SkillCategory {
    OFFENSE,      // Offensive skills
    DEFENSE,      // Defensive skills
    SUPPORT,      // Support skills
    RESOURCE,     // Resource management skills
    LUCK,         // Luck-based skills
    STRATEGY,     // Strategy-based skills
    SPECIAL       // Special skills
}

/**
 * Skill Rarity
 */
enum class SkillRarity {
    COMMON,       // Common skills
    UNCOMMON,     // Uncommon skills
    RARE,         // Rare skills
    EPIC,         // Epic skills
    LEGENDARY     // Legendary skills
}